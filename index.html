<html lang="zh">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="ezin666">
    <title>简易Lofter评论抽奖计票工具</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <script src="xmlhandler.js" defer="true"></script>
    <script src="pollhandler.js" defer="true"></script>
    <script src="utilities.js" defer="true"></script>
  </head>
  <body>
    <div class="main">
      <noscript><p>您的浏览器不支持Javascript!</p></noscript>
      <fieldset><label for="file">XML导出文件：</label><input type="file" onchange="resetFileCache()" accept=".xml" name="xmlpath" id="file" required>
      </fieldset>
      <fieldset><label for="url">Lofter文章地址：</label><input id="url" size="80" onchange="resetFileCache()" type="url" name="posturl" required>
      </fieldset>

      <div class="tab">
        <button class="tablink" onclick="openTab(event,'draw')" id="defaultOpen">抽奖</button>
        <button class="tablink" onclick="openTab(event,'poll')" >计票</button>
      </div>

      <div id="draw" class="tabcontent">
        <button id="drawbutton" onclick="draw()" class="button-sm">抽奖</button>
        <button id="clearbutton" onclick="clearDraw()" class="button-sm">清空</button>
        <div class="error"></div>
        <div id="drawresult"></div>
      </div>
      
      <div id="poll" class="tabcontent">
        <label class="note">
          <p>* 默认只查找阿拉伯数字字符（1, 2, 3...等）。若需要查找汉字数字（一，二，三...等）请填写在关键词一栏。</p>
          <p>* 单选投票默认选择评论中最后出现的数字或关键词。</p>
          <p>* 多个关键词请用中文分号（；）隔开。</p>
        </label>
        <button class="button-sm" onclick="addPollOption()">添加投票选项</button>
        <div id="polloptions"></div>
        <input id="multiselect" name="ismultiselect" type="checkbox">多选投票</input>
        <button id="pollbutton" onclick="process(pollCount)" disabled class="button-sm">计票</button>
        <div class="error"></div>
        <div id="pollresult"></div>
      </div>
    </div>

    <div class="footer">
      <span>Created by <a href="https://github.com/ezin666/lofter-tools" target="_blank">ezin666</a></span>
    </div>
<script>
function openTab(ev, tabName) {
  var i, l, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  tablinks = document.getElementsByClassName("tablink");
  l = tabcontent.length;

  for (i = 0; i < l; ++i) {
    tabcontent[i].style.display = "none";
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  document.getElementById(tabName).style.display = "block";
  ev.currentTarget.className += " active";  
}

// open default tab on page load
document.getElementById("defaultOpen").click();
</script>
  </body>
</html>